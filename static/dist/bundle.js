"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){var i=e(t);return null!=t&&("object"==i||"function"==i)}Object.defineProperty(exports,"__esModule",{value:!0});var i="object"==("undefined"==typeof global?"undefined":e(global))&&global&&global.Object===Object&&global,n="object"==("undefined"==typeof self?"undefined":e(self))&&self&&self.Object===Object&&self,r=i||n||Function("return this")(),l=function(){return r.Date.now()},o=/\s/;var a=/^\s+/;function s(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&o.test(e.charAt(t)););return t}(e)+1).replace(a,""):e}var c=r.Symbol,d=Object.prototype,f=d.hasOwnProperty,u=d.toString,h=c?c.toStringTag:void 0;var p=Object.prototype.toString;var m=c?c.toStringTag:void 0;function v(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":m&&m in Object(e)?function(e){var t=f.call(e,h),i=e[h];try{e[h]=void 0;var n=!0}catch(e){}var r=u.call(e);return n&&(t?e[h]=i:delete e[h]),r}(e):function(e){return p.call(e)}(e)}function g(t){return"symbol"==e(t)||function(t){return null!=t&&"object"==e(t)}(t)&&"[object Symbol]"==v(t)}var b=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,w=/^0o[0-7]+$/i,_=parseInt;function L(e){if("number"==typeof e)return e;if(g(e))return NaN;if(t(e)){var i="function"==typeof e.valueOf?e.valueOf():e;e=t(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var n=y.test(e);return n||w.test(e)?_(e.slice(2),n?2:8):b.test(e)?NaN:+e}var O=Math.max,k=Math.min;function S(e,i,n){var r,o,a,s,c,d,f=0,u=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var i=r,n=o;return r=o=void 0,f=t,s=e.apply(n,i)}function v(e){return f=e,c=setTimeout($,i),u?m(e):s}function g(e){var t=e-d;return void 0===d||t>=i||t<0||h&&e-f>=a}function $(){var e=l();if(g(e))return b(e);c=setTimeout($,function(e){var t=i-(e-d);return h?k(t,a-(e-f)):t}(e))}function b(e){return c=void 0,p&&r?m(e):(r=o=void 0,s)}function y(){var e=l(),t=g(e);if(r=arguments,o=this,d=e,t){if(void 0===c)return v(d);if(h)return clearTimeout(c),c=setTimeout($,i),m(d)}return void 0===c&&(c=setTimeout($,i)),s}return i=L(i)||0,t(n)&&(u=!!n.leading,a=(h="maxWait"in n)?O(L(n.maxWait)||0,i):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==c&&clearTimeout(c),f=0,r=d=o=c=void 0},y.flush=function(){return void 0===c?s:b(l())},y}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var x,E,A={exports:{}};(x=A).exports=(E=function(){var e=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","¢":"cent","£":"pound","¤":"currency","¥":"yen","©":"(c)","ª":"a","®":"(r)","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"DJ","đ":"dj","Ē":"E","ē":"e","Ė":"E","ė":"e","Ę":"e","ę":"e","Ě":"E","ě":"e","Ğ":"G","ğ":"g","Ģ":"G","ģ":"g","Ĩ":"I","ĩ":"i","Ī":"i","ī":"i","Į":"I","į":"i","İ":"I","ı":"i","Ķ":"k","ķ":"k","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","Ō":"O","ō":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"u","ū":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","Ə":"E","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","ǈ":"LJ","ǉ":"lj","ǋ":"NJ","ǌ":"nj","Ș":"S","ș":"s","Ț":"T","ț":"t","ə":"e","˚":"o","Ά":"A","Έ":"E","Ή":"H","Ί":"I","Ό":"O","Ύ":"Y","Ώ":"W","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ϊ":"I","Ϋ":"Y","ά":"a","έ":"e","ή":"h","ί":"i","ΰ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","ς":"s","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ϊ":"i","ϋ":"y","ό":"o","ύ":"y","ώ":"w","Ё":"Yo","Ђ":"DJ","Є":"Ye","І":"I","Ї":"Yi","Ј":"J","Љ":"LJ","Њ":"NJ","Ћ":"C","Џ":"DZ","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","ё":"yo","ђ":"dj","є":"ye","і":"i","ї":"yi","ј":"j","љ":"lj","њ":"nj","ћ":"c","ѝ":"u","џ":"dz","Ґ":"G","ґ":"g","Ғ":"GH","ғ":"gh","Қ":"KH","қ":"kh","Ң":"NG","ң":"ng","Ү":"UE","ү":"ue","Ұ":"U","ұ":"u","Һ":"H","һ":"h","Ә":"AE","ә":"ae","Ө":"OE","ө":"oe","Ա":"A","Բ":"B","Գ":"G","Դ":"D","Ե":"E","Զ":"Z","Է":"E\'","Ը":"Y\'","Թ":"T\'","Ժ":"JH","Ի":"I","Լ":"L","Խ":"X","Ծ":"C\'","Կ":"K","Հ":"H","Ձ":"D\'","Ղ":"GH","Ճ":"TW","Մ":"M","Յ":"Y","Ն":"N","Շ":"SH","Չ":"CH","Պ":"P","Ջ":"J","Ռ":"R\'","Ս":"S","Վ":"V","Տ":"T","Ր":"R","Ց":"C","Փ":"P\'","Ք":"Q\'","Օ":"O\'\'","Ֆ":"F","և":"EV","ء":"a","آ":"aa","أ":"a","ؤ":"u","إ":"i","ئ":"e","ا":"a","ب":"b","ة":"h","ت":"t","ث":"th","ج":"j","ح":"h","خ":"kh","د":"d","ذ":"th","ر":"r","ز":"z","س":"s","ش":"sh","ص":"s","ض":"dh","ط":"t","ظ":"z","ع":"a","غ":"gh","ف":"f","ق":"q","ك":"k","ل":"l","م":"m","ن":"n","ه":"h","و":"w","ى":"a","ي":"y","ً":"an","ٌ":"on","ٍ":"en","َ":"a","ُ":"u","ِ":"e","ْ":"","٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9","پ":"p","چ":"ch","ژ":"zh","ک":"k","گ":"g","ی":"y","۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","฿":"baht","ა":"a","ბ":"b","გ":"g","დ":"d","ე":"e","ვ":"v","ზ":"z","თ":"t","ი":"i","კ":"k","ლ":"l","მ":"m","ნ":"n","ო":"o","პ":"p","ჟ":"zh","რ":"r","ს":"s","ტ":"t","უ":"u","ფ":"f","ქ":"k","ღ":"gh","ყ":"q","შ":"sh","ჩ":"ch","ც":"ts","ძ":"dz","წ":"ts","ჭ":"ch","ხ":"kh","ჯ":"j","ჰ":"h","Ṣ":"S","ṣ":"s","Ẁ":"W","ẁ":"w","Ẃ":"W","ẃ":"w","Ẅ":"W","ẅ":"w","ẞ":"SS","Ạ":"A","ạ":"a","Ả":"A","ả":"a","Ấ":"A","ấ":"a","Ầ":"A","ầ":"a","Ẩ":"A","ẩ":"a","Ẫ":"A","ẫ":"a","Ậ":"A","ậ":"a","Ắ":"A","ắ":"a","Ằ":"A","ằ":"a","Ẳ":"A","ẳ":"a","Ẵ":"A","ẵ":"a","Ặ":"A","ặ":"a","Ẹ":"E","ẹ":"e","Ẻ":"E","ẻ":"e","Ẽ":"E","ẽ":"e","Ế":"E","ế":"e","Ề":"E","ề":"e","Ể":"E","ể":"e","Ễ":"E","ễ":"e","Ệ":"E","ệ":"e","Ỉ":"I","ỉ":"i","Ị":"I","ị":"i","Ọ":"O","ọ":"o","Ỏ":"O","ỏ":"o","Ố":"O","ố":"o","Ồ":"O","ồ":"o","Ổ":"O","ổ":"o","Ỗ":"O","ỗ":"o","Ộ":"O","ộ":"o","Ớ":"O","ớ":"o","Ờ":"O","ờ":"o","Ở":"O","ở":"o","Ỡ":"O","ỡ":"o","Ợ":"O","ợ":"o","Ụ":"U","ụ":"u","Ủ":"U","ủ":"u","Ứ":"U","ứ":"u","Ừ":"U","ừ":"u","Ử":"U","ử":"u","Ữ":"U","ữ":"u","Ự":"U","ự":"u","Ỳ":"Y","ỳ":"y","Ỵ":"Y","ỵ":"y","Ỷ":"Y","ỷ":"y","Ỹ":"Y","ỹ":"y","–":"-","‘":"\'","’":"\'","“":"\\"","”":"\\"","„":"\\"","†":"+","•":"*","…":"...","₠":"ecu","₢":"cruzeiro","₣":"french franc","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","€":"euro","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","₸":"kazakhstani tenge","₹":"indian rupee","₺":"turkish lira","₽":"russian ruble","₿":"bitcoin","℠":"sm","™":"tm","∂":"d","∆":"delta","∑":"sum","∞":"infinity","♥":"love","元":"yuan","円":"yen","﷼":"rial","ﻵ":"laa","ﻷ":"laa","ﻹ":"lai","ﻻ":"la"}'),t=JSON.parse('{"bg":{"Й":"Y","Ц":"Ts","Щ":"Sht","Ъ":"A","Ь":"Y","й":"y","ц":"ts","щ":"sht","ъ":"a","ь":"y"},"de":{"Ä":"AE","ä":"ae","Ö":"OE","ö":"oe","Ü":"UE","ü":"ue","ß":"ss","%":"prozent","&":"und","|":"oder","∑":"summe","∞":"unendlich","♥":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","¢":"centavos","£":"libras","¤":"moneda","₣":"francos","∑":"suma","∞":"infinito","♥":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","¢":"centime","£":"livre","¤":"devise","₣":"franc","∑":"somme","∞":"infini","♥":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","¢":"centavo","∑":"soma","£":"libra","∞":"infinito","♥":"amor"},"uk":{"И":"Y","и":"y","Й":"Y","й":"y","Ц":"Ts","ц":"ts","Х":"Kh","х":"kh","Щ":"Shch","щ":"shch","Г":"H","г":"h"},"vi":{"Đ":"D","đ":"d"},"da":{"Ø":"OE","ø":"oe","Å":"AA","å":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"større end"},"nb":{"&":"og","Å":"AA","Æ":"AE","Ø":"OE","å":"aa","æ":"ae","ø":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","Å":"AA","Ä":"AE","Ö":"OE","å":"aa","ä":"ae","ö":"oe"}}');function i(i,n){if("string"!=typeof i)throw new Error("slugify: string argument expected");var r=t[(n="string"==typeof n?{replacement:n}:n||{}).locale]||{},l=void 0===n.replacement?"-":n.replacement,o=void 0===n.trim||n.trim,a=i.normalize().split("").reduce((function(t,i){var o=r[i]||e[i]||i;return o===l&&(o=" "),t+o.replace(n.remove||/[^\w\s$*_+~.()'"!\-:@]+/g,"")}),"");return n.strict&&(a=a.replace(/[^A-Za-z0-9\s]/g,"")),o&&(a=a.trim()),a=a.replace(/\s+/g,l),n.lower&&(a=a.toLowerCase()),a}return i.extend=function(t){Object.assign(e,t)},i})(),x.exports.default=E();var I=A.exports;const C={headerContetnts:[],includeSections:[],undoTimeList:{},filterList:new Map,filteredHeaders:[]},T=["h1","h2","h3","h4","h5","h6"],V=()=>$(document).find('iframe[name="ace_outer"]').contents(),H=e=>{const t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";let i="";e=e||20;for(let n=0;n<e;n++){const e=Math.floor(Math.random()*t.length);i+=t.substring(e,e+1)}return i},j=e=>{$(`.section_filterList ul li.row_${e.id}`).remove(),$(".section_filterList ul li").length||$(".section_filterList ul").append('<li class="filterEmpty"><p>There is no filter <br> create the first filter</p></li>'),C.filterList.delete(e.id)},M=e=>{let t=!1,i=!1;const n=e.id;if(!e.slug||!e.slug.length)return;const r=location.pathname.split("/");i=r.includes(e.slug),t=r.includes(e.slug),C.filterList.has(n)||C.filterList.set(n,e);const l=$("#filter_listItem").tmpl({filter:C.filterList.get(n),active:t,highlight:i});if($(".section_filterList ul li").length&&$(".section_filterList ul .filterEmpty").remove(),$(`.section_filterList ul li.row_${n}`).length)return!1;const o=`<li\n      class="row_${n}"\n      active="${t}"\n      highlight="${i}"\n      >${$(l).html()}</li>`;t||i?$(".section_filterList ul").prepend(o):$(".section_filterList ul").append(o)},F=()=>{if($("body").hasClass("mobileView"))return;const e=$("button#btn_filterView").offset(),t=$(".modal_filter").outerWidth(!0),i=$("button#btn_filterView").outerWidth(!0);$("#filterModal").css({top:e.top+30,left:e.left-(t+i)+10})},N=e=>{$("#filterModal").toggleClass("popup-show"),$("#filterModal").hasClass("popup-show")&&setTimeout((()=>$(".section_filterList input#filter_name").focus().select()),500),e&&e()},z=e=>!!Array.from(C.filterList.values()).filter((t=>t.slug===e)).length,U=(e,t=[])=>{let i;i=t.length?V().find("iframe").contents().find(t.join(",")).find(":header"):V().find("iframe").contents().find(":header"),C.headerContetnts.splice(0,C.headerContetnts.length),i.each((function(){const e=$(this).text(),t=$(this).parent(),i=t.attr("sectionid"),n=T.indexOf(t.attr("tag")),r=t.attr("titleid"),l=t.attr("lrh0"),o=t.attr("lrh1"),a={text:e,sectionId:i,tag:n,titleId:r,lrh1:o,lastFilter:!1,lrhMark:[l,o,t.attr("lrh2"),t.attr("lrh3"),t.attr("lrh4"),t.attr("lrh5"),t.attr("lrh6")]};C.headerContetnts.push(a)})),$(".section_filterList .totalHeader").text(C.headerContetnts.length),e&&e(C.headerContetnts)},Y=S(((e,t)=>{const i=e;if(!i||i.length<=0)return!1;const n=new RegExp(i,"gi"),r=C.headerContetnts.filter((e=>e.text.match(n)))||[],l=$("#filter_url").val();if(z(l))return $(".btn_createFilter").removeClass("active").attr("disabled",!0),console.info("[headerview]: filter is exists! try andother filter name"),!1;r.length?$(".btn_createFilter").removeAttr("disabled").addClass("active"):$(".btn_createFilter").attr("disabled",!0).removeClass("active"),$(".filterNumResults").text(r.length),t&&t(r)}),200),R=()=>location.pathname.split("/").indexOf("p")>0,P=e=>{const t=$("#editorcontainer");"append"!==e||t.find("#editorSkeletonWrapper").length?"show"===e?t.find("#editorSkeletonWrapper").fadeIn(500):t.find("#editorSkeletonWrapper").fadeOut(600):t.append('\n  <div id="editorSkeletonWrapper">\n    <div id="editorSkeleton">\n      <div class="paragraph">\n        <div class="line header"></div>\n        <div class="line medium"></div>\n        <div class="line large"></div>\n        <div class="line large"></div>\n        <div class="line small"></div>\n      </div>\n      <div class="paragraph">\n        <div class="line header"></div>\n        <div class="line medium"></div>\n        <div class="line large"></div>\n        <div class="line large"></div>\n        <div class="line small"></div>\n      </div>\n      <div class="paragraph">\n        <div class="line header"></div>\n        <div class="line medium"></div>\n        <div class="line large"></div>\n        <div class="line large"></div>\n        <div class="line small"></div>\n      </div>\n    </div>\n  </div>\n')},W=(e,t)=>{const i="active"===t;$(e).attr("active",i),$(e).parent().parent().attr({active:i,highlight:i})},D=()=>{const e=clientVars.ep_singlePad.active;let t=location.pathname.split("/");history&&history.targetPath&&(t=history.targetPath.split("/"));let i=[...t];const n=i.indexOf("p")>0;i.indexOf("p")>0?i=i.splice(0,3):i[1]===clientVars.padId?i=i.splice(0,2):(e&&!n||i[1]!==clientVars.padId)&&(i=[""]);const r=[...t];return 0===r[0].length&&r.shift(),"p"===r[0]&&r.shift(),clientVars.ep_singlePad.active&&r[0]!==clientVars.ep_singlePad.padId||r.shift(),""===r[0]&&r.shift(),r};let J;const G=e=>{e.preventDefault(),e.stopPropagation();const t=$("#filter_name").val(),i=$("#filter_url").val();if($(".section_filterList .loader").show(),!t||!i)return!1;if(z(i))return console.info("[headerview]: The filter already exists"),!1;const n={name:t,id:H(),slug:i};console.info("[headerview]: create filter: ",n),J.emit("addNewFilter",clientVars.padId,n,(e=>{M(e),$(".section_filterList .loader").hide()})),$("#filter_name, #filter_url").val(""),$(".btn_createFilter").removeClass("active").attr("disabled",!0),$(".filterNumResults").text(0)},Z=()=>{$("body").hasClass("mobileView")||$(window).resize(S(F,250)),$(document).on("click",".btn_createFilter",G),$(document).on("submit","#epFilterForm",G),$(document).on("click","button#btn_filterView, button#btnOpenFilterModal",(e=>{N((()=>{F()})),$(".section_filterList .loader").show(),$(".section_filterList ul").css({opacity:0}),J.emit("getFilterList",clientVars.padId,D(),(e=>{$(".section_filterList ul li").remove(),$(".section_filterList ul").append('\n        <li class="filterEmpty">\n          <p>There is no filter <br> create the first filter</p>\n        </li>\n      '),clientVars.ep_headerview.filterList=e,e.forEach((e=>{C.filterList.has(e.id)||C.filterList.set(e.id,e),e&&M(e)})),$(".section_filterList ul").css({opacity:1}),$(".section_filterList .loader").hide()}))}));$(document).on("click","button#btn_filterView, button#btnOpenFilterModal, #filterModal button.btn_closeModal",(()=>{U(null,C.includeSections)})),$(document).on("click","#filterModal button.btn_closeModal",(()=>N())),$(document).on("click",".btn_filter_remove",(function(){const e=$(this).attr("filter-id"),t=$(this).attr("active"),i=$(this).attr("highlight"),n=C.filterList.get(e),r=$("#filter_remove_undo").tmpl({filter:n,active:t,highlight:i});$(`.section_filterList ul li.row_${e}`).html(r),C.undoTimeList[e]=setTimeout((()=>{delete C.undoTimeList[e],J.emit("removeFilter",clientVars.padId,n,(t=>{console.info(`\n          [headerview]: filter has been removed; id ${e}, res: ${t}, filter:`,n),j(n)}))}),2e3)})),$(document).on("click",".btn_undoDelete",(function(){const e=$(this).attr("filter-id"),t=$(this).attr("active"),i=$(this).attr("highlight");clearTimeout(C.undoTimeList[e]),delete C.undoTimeList[e];const n=$("#filter_listItem").tmpl({filter:C.filterList.get(e),active:t,highlight:i});$(`.section_filterList ul li.row_${e}`).html(`\n          <li class="row_${e}" active="${t}" highlight="${i}">\n            ${$(n).html()}\n          </li>\n        `)})),$(document).on("keyup input",".section_form input#filter_name",(function(){const e=$(this).val();Y(e),e.length>0&&$("#filter_url").val(I(e,{lower:!0,strict:!0}))})).on("focusout input",".section_form input#filter_name",(function(){const e=$(this).val();e.length>0&&$("#filter_url").val(I(e,{lower:!0,strict:!0})),$(".filterNumResults").removeClass("active")})).on("focusin input",".section_form input#filter_name",(function(e){const t=$(this).val();$(".filterNumResults").addClass("active"),Y(t)})),$("#filter_url").focusout((function(){const e=$(this).val();e.length>0&&$(this).val(I(e,{lower:!0,strict:!0}))})).focusin((()=>{$(".filterNumResults").addClass("active")})).focusout((()=>{$(".filterNumResults").removeClass("active")})).keyup((function(){const e=$(this).val();z(e)?$(".btn_createFilter").removeClass("active").attr("disabled",!0):$(".btn_createFilter").addClass("active").removeAttr("disabled")}))};exports.aceEditorCSS=()=>[`ep_headerview/static/css/innerLayer.css?v=${clientVars.headerView.version||1}`],exports.postAceInit=(e,t)=>{clientVars.ep_headerview={},(()=>{const e=document.location,t=""===e.port?"https:"===e.protocol?443:80:e.port;let i=`${e.protocol}//${e.hostname}:${t}`;i=`${i}/headerview`,J=io.connect(i,{query:`padId=${clientVars.padId}`}),J.on("disconnect",(e=>{console.error("[headerView]: socket disconnection, reason:",e)})),J.on("connect_error",(e=>{console.error("[headerView]: socket connect_error:",e)})),J.on("addNewFilter",M),J.on("removeFilter",j)})(),$(document).find("head").append('<style id="tocCustomHeader"></style>'),V().find("iframe").contents().find("head").append('<style id="customHeader"></style>'),Z(),P("append");const i=(e,t,i,n)=>`[sectionid='${n}'],[titleid='${t}'][lrh${e}='${i.lrhMark[e]}']`,n=(e,t,i,n)=>{let r="";return r=i.lastFilter?`[sectionid='${n}'],[titleid='${t}'][lrh${e}='${i.lrhMark[e]}']`:`[sectionid='${n}']`,r},r=(e,t)=>{let r="",l=[];const o=[],a={},s=[];let c=location.pathname.split("/");t&&(c=t.split("/"));let d=[...c].splice(R()?3:2,c.length-1);if(clientVars.ep_singlePad.active){d=location.pathname.split("/"),t&&(d=t.split("/"));const e=d.indexOf(clientVars.padId)>=0;R()||e?d=[...c].splice(R()?3:2,c.length-1):d.shift(),e&&(d=d.filter((e=>e!==clientVars.padId)))}if(console.info("[headerview]: filterURL",d,d.indexOf(clientVars.padId)),0===d.length||""===d[0])return V().find("iframe").contents().find("head #customHeader").html(""),$(document).find("head #tocCustomHeader").html(r),P("hide"),!0;d.forEach(((e,t)=>{const i=Array.from(C.filterList.values()).find((t=>t.slug===e)),n=new RegExp(i.name,"gi");a[e]||(a[e]={text:i.name,count:0,sumTagIndex:0,score:0});const r=C.headerContetnts.filter((t=>{const i=t.text.match(n);return i&&(a[e].count+=1,a[e].sumTagIndex+=t.tag),i}));s.push(...r)}));const f=Object.keys(a);f.forEach((e=>{const t=a[e].count,i=a[e].sumTagIndex;a[e].score=i/t}));const u=f.sort(((e,t)=>a[e].score-a[t].score));console.info("[headerview]: sortedSlugs",u);for(const[e,t]of u.entries()){const i=new RegExp(a[t].text,"gi");let n=[];if(0===l.length)n=C.headerContetnts.filter((e=>e.text.match(i))),C.filteredHeaders.push(...n);else{const t=l.map((e=>e.lrh1)),r=l.map((e=>e.titleId));let a=C.headerContetnts.filter((e=>r.includes(e.titleId)));t.some((e=>void 0===e))||(a=C.headerContetnts.filter((e=>t.includes(e.lrh1)))),n=a.filter((e=>e.text.match(i))),C.filteredHeaders.push(...n),e===u.length-1&&(n=n.map((e=>({...e,lastFilter:!0})))),o.push(...n),e>=1&&(l=[])}l.push(...n)}const h=C.filteredHeaders.filter((e=>1===e.tag)).map((e=>e.titleId));if(d.length>1&&(C.filteredHeaders=C.filteredHeaders.filter((e=>h.includes(e.titleId)))),1===d.length){for(const e of C.filteredHeaders){const t=e.tag,n=e.titleId,r=e.lrhMark.filter(((e,i)=>e&&i<=t)).map((r=>i(t,n,e,r)));C.includeSections.push(...r)}for(const e of C.filteredHeaders){const t=e.tag,i=e.titleId,r=e.lrhMark.filter(((e,i)=>e&&i<=t)).map((r=>n(t,i,e,r)));C.includeSections.push(...r)}}else for(const e of o){const t=e.tag,i=e.titleId,r=e.lrhMark.filter(((e,i)=>e&&i<=t)).map((r=>n(t,i,e,r)));C.includeSections.push(...r)}const p=C.includeSections.filter((e=>e&&e)).join(",");r=`\n        div.ace-line:is([tag="h1"],[tag="h2"],[tag="h3"],[tag="h4"],[tag="h5"],[tag="h6"]){\n          pointer-events: none !important;\n          -webkit-user-modify: read-only;\n          -moz-user-modify: read-only;\n          user-modify: read-only;\n          cursor: default;\n        }\n\n        div.ace-line{\n          position: relative;\n        }\n\n        div.ace-line:not(:is(${p})) *   {\n          visibility: hidden;\n          height:0;\n          display:none!important;\n        }\n\n        div.ace-line:is(${p}):after,\n        div.ace-line:is(${p}):before{\n          position: relative;\n          font-size: 1.5em;\n          height: 1em;\n          border: 0;\n          width: 114%;\n        }\n\n        div.ace-line:not(:is(${p})):after,\n        div.ace-line:not(:is(${p})):before,\n        div.ace-line:not(:is(${p})):after,\n        div.ace-line:not(:is(${p})):before{\n          content: "";\n          display: block;\n          position: absolute;\n          left: 0;\n          right: 0;\n          background-size: 2em 100%;\n          height: 50px;\n          width: calc(114% + 0px);\n          left: 50%;\n          transform: translate(-50%,-40px)!important;\n        }\n\n        // div.ace-line:not(:is(${p})):after,\n        // div.ace-line:not(:is(${p})):before{\n        //   -webkit-filter: drop-shadow(hsla(0, 0%, 80%, 0.2) 0px 0px 10px);\n        // }\n\n        // div.ace-line:not(:is(${p})):after,\n        // div.ace-line:not(:is(${p})):before{\n        //   transform: translateY(-20px);\n        // }\n\n        div.ace-line:not(:is(${p})):after{\n          background-position: calc(50% - -4em);\n          background-image:\n          linear-gradient(315deg, #fff 30%, transparent 30%),\n          linear-gradient(45deg, #fff 30%, transparent 30%);\n        }\n\n        div.ace-line:not(:is(${p})):before{\n          background-position: calc(50% - 1em);\n          background-image:\n          linear-gradient(135deg, #fff 30%, transparent 30%),\n          linear-gradient(225deg, #fff 30%, transparent 30%);\n          background-color: #e5e7e8;\n        }\n\n        .dvd {\n          background-image:\n          linear-gradient(135deg, #ddd 30%, transparent 30%),\n          linear-gradient(225deg, #ddd 30%, transparent 30%);\n        }\n\n        div.ace-line:not(:is(${p})){ margin-top:40px; }\n        div.ace-line:not(:is(${p})){ margin-bottom:40px; }\n\n        div.ace-line:heading { color:red }\n      `,V().find("iframe").contents().find("head #customHeader").html(r),(e=>{if(!(clientVars.plugins.plugins||{}).hasOwnProperty("ep_table_of_contents"))return!1;const t=`\n      #tocItems .tocItem{\n        display: none;\n      }\n      #tocItems .tocItem:is(${e}) {\n        display: flex;\n      }\n    `;$(document).find("head #tocCustomHeader").html(t)})(p),P("hide"),U(null,C.includeSections),e&&e()},l=(e={},t)=>{const i=Array.from(C.filterList.values());if(window.softReloadLRHAttributes(),window.history.pushState({type:"filter",filter:e,filterList:i,targetPath:t,target:"filter"},document.title,t),C.filteredHeaders=[],C.includeSections=[],setTimeout((()=>{U((()=>{r(null,t)}))}),500),$("body").hasClass("mobileView")){const e=D();if(0===e.length)return;const t=$("body").find(".notify.filterApply");t.length>0&&t.remove(),$("body").append(`\n        <div class="notify filterApply active">${1===e.length?"Filter":"Filters"} applied</div>\n      `),setTimeout((()=>{$(".notify.filterApply").fadeOut().remove()}),6e3)}};if($("body").hasClass("mobileView")){$("#tableOfContentsModal .header .menue").append('\n      <button id="btnOpenFilterModal">\n        <svg width="394pt" height="394pt" viewBox="-5 0 394 394">\n          <path d="m367.82 0h-351.26c-6.1992-0.011719-11.879 3.4492-14.711 8.9609-2.8711 5.5859-2.3672 12.312 1.3008 17.414l128.69 181.29c0.042968 0.0625 0.089843 0.12109 0.13281 0.18359 4.6758 6.3125 7.207 13.961 7.2188 21.816v147.8c-0.027344 4.375 1.6914 8.582 4.7734 11.688 3.0859 3.1016 7.2812 4.8516 11.656 4.8516 2.2227-0.003906 4.4258-0.44531 6.4805-1.3008l72.312-27.57c6.4766-1.9805 10.777-8.0938 10.777-15.453v-120.02c0.011719-7.8555 2.543-15.504 7.2148-21.816 0.042968-0.0625 0.089844-0.12109 0.13281-0.18359l128.69-181.29c3.668-5.0977 4.1719-11.82 1.3008-17.406-2.8281-5.5156-8.5117-8.9766-14.707-8.9648z"></path>\n        </svg>\n      </button>\n    ');const e=$("#filterMobileView").tmpl();$("#filterHeadersModal .content").append(e)}else{const e=$("#filterViewTemplate").tmpl();$("body").append(e)}$(document).on("touchstart click",".btnFiltersSection",(function(){$(this).parent().find("button").removeClass("active"),$(this).addClass("active"),$(".addSections").hide(),$(".filtersSection").show()})),$(document).on("touchstart click",".btnAddsSection",(function(){$(this).parent().find("button").removeClass("active"),$(this).addClass("active"),$(".filtersSection").hide(),$(".addSections").show(),setTimeout((()=>$(".addSections input#filter_name").focus().select()),500)})),$(document).on("click","#btnOpenFilterModal",(()=>{$("#filterHeadersModal").ndModal()})),$(document).on("click",".section_filterList ul li .filter_name",(function(){$(this).closest("li").find(".btn_filter_act").trigger("click")})),$(document).on("click",'.btn_filter_act[active="true"]',(function(){P("show");const e=$(this).attr("filter-id"),t=C.filterList.get(e),i=location.pathname,n=i.split("/").indexOf(t.slug),r=i.split("/");r.splice(n,1);let o=r.join("/");if(0===o.length&&(o="/"),!t)return!1;W(this,"deactive"),l(t,o)})),$(document).on("click",'.btn_filter_act[active="false"]',(function(){P("show");const e=$(this).attr("filter-id"),t=C.filterList.get(e),i=location.pathname.split("/");i.push(t.slug),""===i[0]&&""===i[1]&&i.shift();const n=i.join("/");window.history.pushState({type:"filter",filter:t,filterList:Array.from(C.filterList.values()),targetPath:n,target:"filter"},t.name),W(this,"active"),l(t,n)})),document.addEventListener("onPushState",(e=>{const{state:t}=e.detail;if("hyperLink"===t.type){const e=t.href;let i=new URL(e);if(i=i.pathname,!i)return;t.target&&"filter"===t.target&&P("show"),0===C.filterList.size?J.emit("getFilterList",clientVars.padId,D(),(e=>{e.forEach((e=>{C.filterList.has(e.id)||C.filterList.set(e.id,e)})),l(null,i)})):l(null,i)}})),clientVars.padId!==clientVars.padView?(P("show"),setTimeout((()=>{U((e=>{J.emit("getFilterList",clientVars.padId,D(),(e=>{e.forEach((e=>{C.filterList.has(e.id)||C.filterList.set(e.id,e)}));const t=location.pathname.split("/").pop(),i=e.find((e=>e.slug===t));window.history.pushState({type:"filter",filter:i,filterList:e},document.title),r()}))}))}),1e3)):P("hide")};//# sourceMappingURL=bundle.js.map
